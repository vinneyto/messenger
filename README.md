# Проект Messenger

Одностраничное приложение для обмена сообщениями с навигацией с помощью History API.

Проект доступен по [ссылке](https://vinneyto-messenger.netlify.app)

## Дизайн проекта

Дизайн проекта доступен в Figma: [Messenger Design](https://www.figma.com/design/jF5fFFzgGOxQeB4CmKWTiE/Chat_external_link?node-id=1-2&node-type=frame&t=3BpyEcngQiIQeE4d-0)

## Установка зависимостей

Для установки зависимостей выполните команду:

    npm install

## Запуск

Для сборки и отдачи собранной статики используйте команду

    npm run start

Для запуска dev сервера используйте команду

    npm run dev

## Доступные страницы

- [Список чатов](https://vinneyto-messenger.netlify.app)
- [Авторизация](https://vinneyto-messenger.netlify.app/sign-in)
- [Регистрация](https://vinneyto-messenger.netlify.app/sign-up)
- [Профиль пользователя](https://vinneyto-messenger.netlify.app/user-profile)
- [Данные пользователя](https://vinneyto-messenger.netlify.app/user-profile-data)
- [Сброс пароля](https://vinneyto-messenger.netlify.app/user-profile-password)
- [Ошибка 404](https://vinneyto-messenger.netlify.app/404)
- [Ошибка 500](https://vinneyto-messenger.netlify.app/500)

## Структура проекта

Проект построен на компонентах, каждый из которых представляет собой шаблон Handlebars и CSS-модуль.

Переиспользуемые компоненты находятся в папке **components**, а компоненты для страниц - в папке **pages**.

Для переключения между страницами используется миниатюрный роутер на основе History API.

## Изменения ко второму спринту

### Компоненты

- Все компоненты переведены на классы, унаследованные от Block.ts

### Block.ts

- В классе Block.ts по сравнению с заготовкой из курса есть одно изменение - у него нет фиксированного корневого элемента. Это сделано, чтобы можно было брать готовые шаблоны и не разделять их корневой элемент и вложенные, а также чтобы не делать лишний оберточный элемент, если мы рендерим в него шаблон целиком.
- В блоке есть props и events - они описываются через дженерики блока.

### Динамическое монтирование

- Для вставки компонента в родителя используется "динамическое монтирование" - класс BlockRenderTarget. Этот класс следит за перерендером компонента и автоматически делает реплейс корневого элемента на новый.
- Ограничение - если корневой элемент является корневым элементом дочернего компонента, такая схема работать не будет.

### Рендеринг

- Первый рендер компонента происходит не в конструкторе, а только после монтирования. Это сделано для того, чтобы в конструкторе можно было подписаться на события, ссылаясь на this, уже после вызова super и не опасаться, что это сделано после отрисовки. Соответственно, компонент монтируется с помощью метода mount (как главный компонент страницы, так и любые дочерние компоненты также будут монтироваться в DOM родительского компонента).

### Уничтожение компонентов

- У блока есть метод destroy, который удаляет все ресурсы блока и отменяет все подписки. Родительский блок владеет блоками детей и может их уничтожать, если они заменяются на новый экземпляр через props.

### Корневой элемент

- Корневым элементом приложения является AppRouterBlock.ts, который содержит одного ребенка - блок текущей страницы.

### Валидация форм

- Базовой единицей валидации формы является класс InputGroupBase.ts, от него наследуются поля форм и поле ввода сообщения.
- Для валидации формы целиком есть функция validate, которая находит все InputGroupBase в пропсах блока формы и проверяет их. Если валидация прошла, возвращает объект с данными.
